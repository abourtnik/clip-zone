import { useState} from 'preact/hooks';
import {clsx} from "clsx";
import {ImgHTMLAttributes} from "react";

type Props = {
    source: string,
    title?: string,
    hover?: boolean
} & ImgHTMLAttributes;

export default function ImageLoaded ({source, title = '', hover = false, ...props} : Props) {

    const [loading, setLoading] = useState<boolean>(true);

    const imageLoad = () => {
        setLoading(false);
    }

    const placeholder = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAs4AAAGUCAYAAAAlEaQgAAAAAXNSR0IArs4c6QAAF2hJREFUeF7t1qERhEAQRUHGkn9mgCUOFFwERz1Pr/5mu0a8OY7jue978QgQIECAAAECBAgQ+C8w27Y9gAgQIECAAAECBAgQeBcQzi6EAAECBAgQIECAQBAQzgHJhAABAgQIECBAgIBwdgMECBAgQIAAAQIEgoBwDkgmBAgQIECAAAECBISzGyBAgAABAgQIECAQBIRzQDIhQIAAAQIECBAgIJzdAAECBAgQIECAAIEgIJwDkgkBAgQIECBAgAAB4ewGCBAgQIAAAQIECAQB4RyQTAgQIECAAAECBAgIZzdAgAABAgQIECBAIAgI54BkQoAAAQIECBAgQEA4uwECBAgQIECAAAECQUA4ByQTAgQIECBAgAABAsLZDRAgQIAAAQIECBAIAsI5IJkQIECAAAECBAgQEM5ugAABAgQIECBAgEAQEM4ByYQAAQIECBAgQICAcHYDBAgQIECAAAECBIKAcA5IJgQIECBAgAABAgSEsxsgQIAAAQIECBAgEASEc0AyIUCAAAECBAgQICCc3QABAgQIECBAgACBICCcA5IJAQIECBAgQIAAAeHsBggQIECAAAECBAgEAeEckEwIECBAgAABAgQICGc3QIAAAQIECBAgQCAICOeAZEKAAAECBAgQIEBAOLsBAgQIECBAgAABAkFAOAckEwIECBAgQIAAAQLC2Q0QIECAAAECBAgQCALCOSCZECBAgAABAgQIEBDOboAAAQIECBAgQIBAEBDOAcmEAAECBAgQIECAgHB2AwQIECBAgAABAgSCgHAOSCYECBAgQIAAAQIEhLMbIECAAAECBAgQIBAEhHNAMiFAgAABAgQIECAgnN0AAQIECBAgQIAAgSAgnAOSCQECBAgQIECAAAHh7AYIECBAgAABAgQIBAHhHJBMCBAgQIAAAQIECAhnN0CAAAECBAgQIEAgCAjngGRCgAABAgQIECBAQDi7AQIECBAgQIAAAQJBQDgHJBMCBAgQIECAAAECwtkNECBAgAABAgQIEAgCwjkgmRAgQIAAAQIECBAQzm6AAAECBAgQIECAQBAQzgHJhAABAgQIECBAgIBwdgMECBAgQIAAAQIEgoBwDkgmBAgQIECAAAECBISzGyBAgAABAgQIECAQBIRzQDIhQIAAAQIECBAgIJzdAAECBAgQIECAAIEgIJwDkgkBAgQIECBAgAAB4ewGCBAgQIAAAQIECAQB4RyQTAgQIECAAAECBAgIZzdAgAABAgQIECBAIAgI54BkQoAAAQIECBAgQEA4uwECBAgQIECAAAECQUA4ByQTAgQIECBAgAABAsLZDRAgQIAAAQIECBAIAsI5IJkQIECAAAECBAgQEM5ugAABAgQIECBAgEAQEM4ByYQAAQIECBAgQICAcHYDBAgQIECAAAECBIKAcA5IJgQIECBAgAABAgSEsxsgQIAAAQIECBAgEASEc0AyIUCAAAECBAgQICCc3QABAgQIECBAgACBICCcA5IJAQIECBAgQIAAAeHsBggQIECAAAECBAgEAeEckEwIECBAgAABAgQICGc3QIAAAQIECBAgQCAICOeAZEKAAAECBAgQIEBAOLsBAgQIECBAgAABAkFAOAckEwIECBAgQIAAAQLC2Q0QIECAAAECBAgQCALCOSCZECBAgAABAgQIEBDOboAAAQIECBAgQIBAEBDOAcmEAAECBAgQIECAgHB2AwQIECBAgAABAgSCgHAOSCYECBAgQIAAAQIEhLMbIECAAAECBAgQIBAEhHNAMiFAgAABAgQIECAgnN0AAQIECBAgQIAAgSAgnAOSCQECBAgQIECAAAHh7AYIECBAgAABAgQIBAHhHJBMCBAgQIAAAQIECAhnN0CAAAECBAgQIEAgCAjngGRCgAABAgQIECBAQDi7AQIECBAgQIAAAQJBQDgHJBMCBAgQIECAAAECwtkNECBAgAABAgQIEAgCwjkgmRAgQIAAAQIECBAQzm6AAAECBAgQIECAQBAQzgHJhAABAgQIECBAgIBwdgMECBAgQIAAAQIEgoBwDkgmBAgQIECAAAECBISzGyBAgAABAgQIECAQBIRzQDIhQIAAAQIECBAgIJzdAAECBAgQIECAAIEgIJwDkgkBAgQIECBAgAAB4ewGCBAgQIAAAQIECAQB4RyQTAgQIECAAAECBAgIZzdAgAABAgQIECBAIAgI54BkQoAAAQIECBAgQEA4uwECBAgQIECAAAECQUA4ByQTAgQIECBAgAABAsLZDRAgQIAAAQIECBAIAsI5IJkQIECAAAECBAgQEM5ugAABAgQIECBAgEAQEM4ByYQAAQIECBAgQICAcHYDBAgQIECAAAECBIKAcA5IJgQIECBAgAABAgSEsxsgQIAAAQIECBAgEASEc0AyIUCAAAECBAgQICCc3QABAgQIECBAgACBICCcA5IJAQIECBAgQIAAAeHsBggQIECAAAECBAgEAeEckEwIECBAgAABAgQICGc3QIAAAQIECBAgQCAICOeAZEKAAAECBAgQIEBAOLsBAgQIECBAgAABAkFAOAckEwIECBAgQIAAAQLC2Q0QIECAAAECBAgQCALCOSCZECBAgAABAgQIEBDOboAAAQIECBAgQIBAEBDOAcmEAAECBAgQIECAgHB2AwQIECBAgAABAgSCgHAOSCYECBAgQIAAAQIEhLMbIECAAAECBAgQIBAEhHNAMiFAgAABAgQIECAgnN0AAQIECBAgQIAAgSAgnAOSCQECBAgQIECAAAHh7AYIECBAgAABAgQIBAHhHJBMCBAgQIAAAQIECAhnN0CAAAECBAgQIEAgCAjngGRCgAABAgQIECBAQDi7AQIECBAgQIAAAQJBQDgHJBMCBAgQIECAAAECwtkNECBAgAABAgQIEAgCwjkgmRAgQIAAAQIECBAQzm6AAAECBAgQIECAQBAQzgHJhAABAgQIECBAgIBwdgMECBAgQIAAAQIEgoBwDkgmBAgQIECAAAECBISzGyBAgAABAgQIECAQBIRzQDIhQIAAAQIECBAgIJzdAAECBAgQIECAAIEgIJwDkgkBAgQIECBAgAAB4ewGCBAgQIAAAQIECAQB4RyQTAgQIECAAAECBAgIZzdAgAABAgQIECBAIAgI54BkQoAAAQIECBAgQEA4uwECBAgQIECAAAECQUA4ByQTAgQIECBAgAABAsLZDRAgQIAAAQIECBAIAsI5IJkQIECAAAECBAgQEM5ugAABAgQIECBAgEAQEM4ByYQAAQIECBAgQICAcHYDBAgQIECAAAECBIKAcA5IJgQIECBAgAABAgSEsxsgQIAAAQIECBAgEASEc0AyIUCAAAECBAgQICCc3QABAgQIECBAgACBICCcA5IJAQIECBAgQIAAAeHsBggQIECAAAECBAgEAeEckEwIECBAgAABAgQICGc3QIAAAQIECBAgQCAICOeAZEKAAAECBAgQIEBAOLsBAgQIECBAgAABAkFAOAckEwIECBAgQIAAAQLC2Q0QIECAAAECBAgQCALCOSCZECBAgAABAgQIEBDOboAAAQIECBAgQIBAEBDOAcmEAAECBAgQIECAgHB2AwQIECBAgAABAgSCgHAOSCYECBAgQIAAAQIEhLMbIECAAAECBAgQIBAEhHNAMiFAgAABAgQIECAgnN0AAQIECBAgQIAAgSAgnAOSCQECBAgQIECAAAHh7AYIECBAgAABAgQIBAHhHJBMCBAgQIAAAQIECAhnN0CAAAECBAgQIEAgCAjngGRCgAABAgQIECBAQDi7AQIECBAgQIAAAQJBQDgHJBMCBAgQIECAAAECwtkNECBAgAABAgQIEAgCwjkgmRAgQIAAAQIECBAQzm6AAAECBAgQIECAQBAQzgHJhAABAgQIECBAgIBwdgMECBAgQIAAAQIEgoBwDkgmBAgQIECAAAECBISzGyBAgAABAgQIECAQBIRzQDIhQIAAAQIECBAgIJzdAAECBAgQIECAAIEgIJwDkgkBAgQIECBAgAAB4ewGCBAgQIAAAQIECAQB4RyQTAgQIECAAAECBAgIZzdAgAABAgQIECBAIAgI54BkQoAAAQIECBAgQEA4uwECBAgQIECAAAECQUA4ByQTAgQIECBAgAABAsLZDRAgQIAAAQIECBAIAsI5IJkQIECAAAECBAgQEM5ugAABAgQIECBAgEAQEM4ByYQAAQIECBAgQICAcHYDBAgQIECAAAECBIKAcA5IJgQIECBAgAABAgSEsxsgQIAAAQIECBAgEASEc0AyIUCAAAECBAgQICCc3QABAgQIECBAgACBICCcA5IJAQIECBAgQIAAAeHsBggQIECAAAECBAgEAeEckEwIECBAgAABAgQICGc3QIAAAQIECBAgQCAICOeAZEKAAAECBAgQIEBAOLsBAgQIECBAgAABAkFAOAckEwIECBAgQIAAAQLC2Q0QIECAAAECBAgQCALCOSCZECBAgAABAgQIEBDOboAAAQIECBAgQIBAEBDOAcmEAAECBAgQIECAgHB2AwQIECBAgAABAgSCgHAOSCYECBAgQIAAAQIEhLMbIECAAAECBAgQIBAEhHNAMiFAgAABAgQIECAgnN0AAQIECBAgQIAAgSAgnAOSCQECBAgQIECAAAHh7AYIECBAgAABAgQIBAHhHJBMCBAgQIAAAQIECAhnN0CAAAECBAgQIEAgCAjngGRCgAABAgQIECBAQDi7AQIECBAgQIAAAQJBQDgHJBMCBAgQIECAAAECwtkNECBAgAABAgQIEAgCwjkgmRAgQIAAAQIECBAQzm6AAAECBAgQIECAQBAQzgHJhAABAgQIECBAgIBwdgMECBAgQIAAAQIEgoBwDkgmBAgQIECAAAECBISzGyBAgAABAgQIECAQBIRzQDIhQIAAAQIECBAgIJzdAAECBAgQIECAAIEgIJwDkgkBAgQIECBAgAAB4ewGCBAgQIAAAQIECAQB4RyQTAgQIECAAAECBAgIZzdAgAABAgQIECBAIAgI54BkQoAAAQIECBAgQEA4uwECBAgQIECAAAECQUA4ByQTAgQIECBAgAABAsLZDRAgQIAAAQIECBAIAsI5IJkQIECAAAECBAgQEM5ugAABAgQIECBAgEAQEM4ByYQAAQIECBAgQICAcHYDBAgQIECAAAECBIKAcA5IJgQIECBAgAABAgSEsxsgQIAAAQIECBAgEASEc0AyIUCAAAECBAgQICCc3QABAgQIECBAgACBICCcA5IJAQIECBAgQIAAAeHsBggQIECAAAECBAgEAeEckEwIECBAgAABAgQICGc3QIAAAQIECBAgQCAICOeAZEKAAAECBAgQIEBAOLsBAgQIECBAgAABAkFAOAckEwIECBAgQIAAAQLC2Q0QIECAAAECBAgQCALCOSCZECBAgAABAgQIEBDOboAAAQIECBAgQIBAEBDOAcmEAAECBAgQIECAgHB2AwQIECBAgAABAgSCgHAOSCYECBAgQIAAAQIEhLMbIECAAAECBAgQIBAEhHNAMiFAgAABAgQIECAgnN0AAQIECBAgQIAAgSAgnAOSCQECBAgQIECAAAHh7AYIECBAgAABAgQIBAHhHJBMCBAgQIAAAQIECAhnN0CAAAECBAgQIEAgCAjngGRCgAABAgQIECBAQDi7AQIECBAgQIAAAQJBQDgHJBMCBAgQIECAAAECwtkNECBAgAABAgQIEAgCwjkgmRAgQIAAAQIECBAQzm6AAAECBAgQIECAQBAQzgHJhAABAgQIECBAgIBwdgMECBAgQIAAAQIEgoBwDkgmBAgQIECAAAECBISzGyBAgAABAgQIECAQBIRzQDIhQIAAAQIECBAgIJzdAAECBAgQIECAAIEgIJwDkgkBAgQIECBAgAAB4ewGCBAgQIAAAQIECAQB4RyQTAgQIECAAAECBAgIZzdAgAABAgQIECBAIAgI54BkQoAAAQIECBAgQEA4uwECBAgQIECAAAECQUA4ByQTAgQIECBAgAABAsLZDRAgQIAAAQIECBAIAsI5IJkQIECAAAECBAgQEM5ugAABAgQIECBAgEAQEM4ByYQAAQIECBAgQICAcHYDBAgQIECAAAECBIKAcA5IJgQIECBAgAABAgSEsxsgQIAAAQIECBAgEASEc0AyIUCAAAECBAgQICCc3QABAgQIECBAgACBICCcA5IJAQIECBAgQIAAAeHsBggQIECAAAECBAgEAeEckEwIECBAgAABAgQICGc3QIAAAQIECBAgQCAICOeAZEKAAAECBAgQIEBAOLsBAgQIECBAgAABAkFAOAckEwIECBAgQIAAAQLC2Q0QIECAAAECBAgQCALCOSCZECBAgAABAgQIEBDOboAAAQIECBAgQIBAEBDOAcmEAAECBAgQIECAgHB2AwQIECBAgAABAgSCgHAOSCYECBAgQIAAAQIEhLMbIECAAAECBAgQIBAEhHNAMiFAgAABAgQIECAgnN0AAQIECBAgQIAAgSAgnAOSCQECBAgQIECAAAHh7AYIECBAgAABAgQIBAHhHJBMCBAgQIAAAQIECAhnN0CAAAECBAgQIEAgCAjngGRCgAABAgQIECBAQDi7AQIECBAgQIAAAQJBQDgHJBMCBAgQIECAAAECwtkNECBAgAABAgQIEAgCwjkgmRAgQIAAAQIECBAQzm6AAAECBAgQIECAQBAQzgHJhAABAgQIECBAgIBwdgMECBAgQIAAAQIEgoBwDkgmBAgQIECAAAECBISzGyBAgAABAgQIECAQBIRzQDIhQIAAAQIECBAgIJzdAAECBAgQIECAAIEgIJwDkgkBAgQIECBAgAAB4ewGCBAgQIAAAQIECAQB4RyQTAgQIECAAAECBAgIZzdAgAABAgQIECBAIAgI54BkQoAAAQIECBAgQEA4uwECBAgQIECAAAECQUA4ByQTAgQIECBAgAABAsLZDRAgQIAAAQIECBAIAsI5IJkQIECAAAECBAgQEM5ugAABAgQIECBAgEAQEM4ByYQAAQIECBAgQICAcHYDBAgQIECAAAECBIKAcA5IJgQIECBAgAABAgSEsxsgQIAAAQIECBAgEASEc0AyIUCAAAECBAgQICCc3QABAgQIECBAgACBICCcA5IJAQIECBAgQIAAAeHsBggQIECAAAECBAgEAeEckEwIECBAgAABAgQICGc3QIAAAQIECBAgQCAICOeAZEKAAAECBAgQIEBAOLsBAgQIECBAgAABAkFAOAckEwIECBAgQIAAAQLC2Q0QIECAAAECBAgQCALCOSCZECBAgAABAgQIEBDOboAAAQIECBAgQIBAEBDOAcmEAAECBAgQIECAgHB2AwQIECBAgAABAgSCgHAOSCYECBAgQIAAAQIEhLMbIECAAAECBAgQIBAEhHNAMiFAgAABAgQIECAgnN0AAQIECBAgQIAAgSAgnAOSCQECBAgQIECAAAHh7AYIECBAgAABAgQIBAHhHJBMCBAgQIAAAQIECAhnN0CAAAECBAgQIEAgCAjngGRCgAABAgQIECBAQDi7AQIECBAgQIAAAQJBQDgHJBMCBAgQIECAAAECwtkNECBAgAABAgQIEAgCwjkgmRAgQIAAAQIECBAQzm6AAAECBAgQIECAQBAQzgHJhAABAgQIECBAgIBwdgMECBAgQIAAAQIEgoBwDkgmBAgQIECAAAECBISzGyBAgAABAgQIECAQBIRzQDIhQIAAAQIECBAgIJzdAAECBAgQIECAAIEgIJwDkgkBAgQIECBAgAAB4ewGCBAgQIAAAQIECAQB4RyQTAgQIECAAAECBAgIZzdAgAABAgQIECBAIAgI54BkQoAAAQIECBAgQEA4uwECBAgQIECAAAECQUA4ByQTAgQIECBAgAABAsLZDRAgQIAAAQIECBAIArPv+xN2JgQIECBAgAABAgQ+LTDneV7rui4z82kInydAgAABAgQIECDwJqCW3QcBAgQIECBAgACBIPADYwZ7BgQTqgYAAAAASUVORK5CYII=';

    return (
        <>
            {
                loading &&
                <img {...props} src={placeholder} alt={'default'}/>
            }
            <div className={clsx(props.class,'image-box position-relative overflow-hidden', (hover && !loading) && 'hover')}>
                <img {...props} className={clsx(props.class, loading && 'd-none', !loading && 'd-block')} src={source} alt={title} onLoad={imageLoad}/>
            </div>
        </>
    )
}
